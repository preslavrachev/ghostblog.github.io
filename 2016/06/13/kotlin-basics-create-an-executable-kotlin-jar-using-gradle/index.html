<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

				<title>Kotlin Basics: Create Executable Kotlin JARs, using Gradle</title>

	<meta name="HandheldFriendly" content="True" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" type="text/css" href="/assets/css/style.css?v=7d79bd6108" />
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/amp/" />
    
    <meta property="og:site_name" content="Preslav Rachev" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Kotlin Basics: Create Executable Kotlin JARs, using Gradle" />
    <meta property="og:description" content="Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR." />
    <meta property="og:url" content="https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta property="article:published_time" content="2016-06-13T05:22:00.000Z" />
    <meta property="article:modified_time" content="2018-12-06T06:25:39.000Z" />
    <meta property="article:tag" content="Programming" />
    <meta property="article:tag" content="Kotlin" />
    <meta property="article:tag" content="Gradle" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Kotlin Basics: Create Executable Kotlin JARs, using Gradle" />
    <meta name="twitter:description" content="Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR." />
    <meta name="twitter:url" content="https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Preslav Rachev" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Programming, Kotlin, Gradle" />
    <meta name="twitter:site" content="@preslavrachev" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Preslav Rachev",
        "logo": {
            "@type": "ImageObject",
            "url": "https://preslav.me/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Preslav Rachev",
        "image": {
            "@type": "ImageObject",
            "url": "https://preslav.me/content/images/2018/12/3Uv6SjbG_400x400.jpg",
            "width": 400,
            "height": 400
        },
        "url": "https://preslav.me/author/preslav/",
        "sameAs": []
    },
    "headline": "Kotlin Basics: Create Executable Kotlin JARs, using Gradle",
    "url": "https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/",
    "datePublished": "2016-06-13T05:22:00.000Z",
    "dateModified": "2018-12-06T06:25:39.000Z",
    "keywords": "Programming, Kotlin, Gradle",
    "description": "Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to: Set up a Gradle project that supports Kotlin Add a starting function Configure your build to call this function when you execute your JAR.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://preslav.me/"
    }
}
    </script>

    <script src="/public/ghost-sdk.min.js?v=7d79bd6108"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "2a78cd55fca9"
});
</script>
    <meta name="generator" content="Ghost 2.6" />
    <link rel="alternate" type="application/rss+xml" title="Preslav Rachev" href="https://preslav.me/rss/" />
    <link href="https://micro.blog/preslavrachev" rel="me" />
<link href="https://github.com/preslavrachev" rel="me" />

<link rel="micropub" href="https://untitled-ijfrpfomttsw.runkit.sh/micropub">
<link rel="token_endpoint" href="https://tokens.indieauth.com/token">
<link rel="authorization_endpoint" href="https://indieauth.com/auth">

<style>
    .post-full-content pre {
    	margin: 1.5em 0 3em !important;
	}
    
    .blog-description: {
        background-color: #37353dad;
    	padding: 1rem;
    }
    
    
     /* Atilla-related
    .inner {
    	max-width: 36em !important;
    }
    
    .blog-cover {
    	opacity: 0.7;
        animation: none;
    }
    
    .post-comments: {
    	display:auto !important;
    }
    */
    
    .blog-cover {
    	opacity: 0.7;
        animation: none;
    }
    
    #post-header.has-cover {
    	padding-top: 4em;
    }
    
    #blog-header.has-cover {
    	padding: 2em 0 2em;
    }  
</style>
</head>

<body class="post-template tag-programming tag-kotlin tag-gradle">

	<nav id="menu">
	<a class="close-button">Close</a>
	<div class="nav-wrapper">
		<p class="nav-label">Menu</p>
		<ul>
			<li class="nav-home" role="presentation"><a href="https://preslav.me/">Home</a></li>
			<li class="nav-about" role="presentation"><a href="https://preslav.me/about-me/">About</a></li>
			<li class="nav-munich-tech-community" role="presentation"><a href="https://preslav.me/aggregated-munich-tech-community/">Munich Tech Community</a></li>
			<li class="nav-devnotes" role="presentation"><a href="https://devnotes.space">DevNotes</a></li>
			<li class="nav-blogroll" role="presentation"><a href="https://preslav.me/blogroll/">Blogroll</a></li>
			<li class="nav-contact" role="presentation"><a href="https://preslav.me/contact/">Contact</a></li>
			<li class="nav-twitter"><a href="https://twitter.com/preslavrachev" title="@preslavrachev"><i class="ic ic-twitter"></i> Twitter</a></li>
			<li class="nav-rss"><a href="https://preslav.me/rss/"><i class="ic ic-rss"></i> Subscribe</a></li>
		</ul>
	</div>
</nav>


	<section id="wrapper">
		<a class="hidden-close"></a>
		

<div class="progress-container">
	<span class="progress-bar"></span>
</div>

<header id="post-header">
	<div class="inner">
		<nav id="navigation">
			<span id="home-button" class="nav-button">
				<a class="home-button" href="https://preslav.me" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
			</span>
			<span id="menu-button" class="nav-button">
				<a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
			</span>
		</nav>
			<h1 class="post-title">Kotlin Basics: Create Executable Kotlin JARs, using Gradle</h1>
			<span class="post-meta"><a href="/about-me">Preslav Rachev</a> on <a href="/tag/programming/">Programming</a>, <a href="/tag/kotlin/">Kotlin</a>, <a href="/tag/gradle/">Gradle</a> | <time datetime="2016-06-13">13 Jun 2016</time></span>
				
		
	</div>
</header>

<main class="content" role="main">
	<article class="post tag-programming tag-kotlin tag-gradle">
		<div class="inner">

			<section class="post-content">
				<p>Kotlin is great for creating small command-line utilities, which can be packaged and distributed as normal JAR files. This short tutorial will show you how to:</p>
<ul>
<li>Set up a Gradle project that supports Kotlin</li>
<li>Add a starting function</li>
<li>Configure your build to call this function when you execute your JAR.</li>
</ul>
<h3 id="settingupkotlindependencies">Setting up Kotlin dependencies</h3>
<pre><code class="language-groovy">apply plugin: 'java'
apply plugin: 'kotlin'

//… other stuff, you typically find in a Gradle build file

dependencies {
     // other dependencies …
    compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;
}

buildscript {
     ext.kotlin_version = '1.0.2'
     //...
     compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;
}
</code></pre>
<p>You will also want your IDE (I assume you’re using IntelliJ or Android Studio) to mark the directory where your Kotlin source code resides as a source directory. Since Kotlin and Java are best friends, it is perfectly fine to keep the same package structure. It is a good practice though, to keep your Kotlin code physically separate from your Java one. Thus, you’d typically have two folders under <code>src</code> - <code>src/main/java</code> for Java classes, and <code>src/main/kotlin</code> for Kotlin ones. Same for tests. Again, in your <code>build.gradle</code> file, add the following:</p>
<pre><code class="language-groovy">sourceSets {
    main.java.srcDirs += 'src/main/kotlin/'
    test.java.srcDirs += 'src/test/kotlin/'
}
</code></pre>
<p>Using IntelliJ, you could rely not he IDE to guide you with all of this, but I wanted to show you the basics, since one may not always rely on the comfort of an IDE. To see that everything is working as it should, go to your project directory and create a new build:</p>
<pre><code class="language-bash">grade clean build
</code></pre>
<p>If everything has been set up correctly, you should be able to see a task named <code>compileKotlin</code> which the build has executed successfully.</p>
<h3 id="writeyourfirstkotlinprogram">Write your first Kotlin program</h3>
<p>Unlike Java, Kotlin is friendlier with functions that reside outside of any class scope. You can create a <code>Main</code> class hosting a <code>main()</code> function, or you can create a top-level <code>main()</code> without necessarily wrapping it in a class. Perhaps, you wouldn't be able to find any difference in a such a brief examaple, but I find the possibility to create top-level functions helpful in reducing boilerplate code.</p>
<p>Here is the mandatory HelloWorld example. Create a file with an arbitrary name (say <code>Main</code>) and an extension <code>.kt</code>, and write simply:</p>
<pre><code class="language-groovy">fun main(args : Array&lt;String&gt;) { 
  println(&quot;Hello, world!&quot;) 
}
</code></pre>
<p>Note that adding a package is optional, as well as ending your lines with semicolons. In order to keep consistency with my Java code though, I'd usually add both, and expect that people I work with, do the same.</p>
<h3 id="configureyourgradlebuildtocreateanexecutablejar">Configure your Gradle build to create an executable JAR</h3>
<p>The <code>main</code> function we just added, is enough to test setting up an executable JAR, which one should then be able to call simply by executing:</p>
<pre><code class="language-bash">java -jar &lt;MY_PROJECT_NAME&gt;.jar
</code></pre>
<p>If you simply try to build your project and then execute the above command, we would get the following message:</p>
<pre><code class="language-bash">no main manifest attribute &lt;PATH_TO_MY_PROJECT_JAR&gt;.jar
</code></pre>
<p>This means that we have to configure <code>jar</code> task, which Java Gradle builds go through, and tell it which the starting point of our project is. In a Java project, this would be the path to the class where our <code>main()</code> function resides:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.myname.myprojectname.Main'
    }
}
</code></pre>
<p>Wait a minute? We have defined our <code>main()</code> function outisde of any class scope. That's true and not entirely true at the same time. Actually, to keep things at the bytecode level consistent, and backwards-compatible with the JVM, the Kotlin compiler adds all top-level functions to respective classes. In our case, the class generated by the Kotlin compiler would have the same name the filename of the file where our function resides, plus the suffix <code>Kt</code>. This means, for example, that if our file is called <code>Main.kt</code>, the Kotlin compiler would generate a class with the name <code>MainKt.class</code> and add it to the generated JAR file. Knowing this, one could rewrite the Gradle configuration above, as follows:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.myname.myprojectname.MainKt'
    }
}
</code></pre>
<p><strong>Note:</strong> You can specifiy the name this class should be compiled with, by adding a file-scope annotation on top of your file, even before the <code>package</code> decalration:</p>
<pre><code class="language-kotlin">@file:JvmName(&quot;MainCls&quot;)
</code></pre>
<p>This new name can be used within the JAR manifest configuration, as shown above.</p>
<p>Even though we specified our main class correctly in our JAR manifest configuration, if we try to execute our main function using <code>jar -jar</code>, we will still see an error message:</p>
<pre><code class="language-bash">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: kotlin/jvm/internal/Intrinsics
	at com.preslavrachev.imdbparser.MainKt.main(Main.kt)
Caused by: java.lang.ClassNotFoundException: kotlin.jvm.internal.Intrinsics
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	... 1 more
</code></pre>
<p>Experienced Java developers will quickly recognize this type of exception. By default when Gradle (as well as Maven) packs some Java class files into a JAR file, it is assumed that this JAR file will be referenced by an application, where all of its dependencies are also accessible within the classpath of the loading application. To execute a JAR without having to specifiy the path to itse dependencies, one must tell the build system to take all of this JAR's referenced dependencies and copy them as part of the JAR itself. In the Java community, this is known as a &quot;fat JAR&quot;. In a &quot;fat JAR&quot; all of the dependencies end up within the class path of the loading application, so code can be executed without problems. The only downside to creating fat JARs is of course their growing file size (which kind of explains the name), though in most situations, it is not a big concern. In order to tell Gradle to copy all of a JAR's dependencies, one should simply modify the abovementioned JAR task configuration, by adding the following piece of code:</p>
<pre><code class="language-groovy">jar {
    manifest {
        attributes 'Main-Class': 'com.preslavrachev.imdbparser.MainKt'
    }

    // This line of code recursively collects and copies all of a project's files
    // and adds them to the JAR itself. One can extend this task, to skip certain 
    // files or particular types at will
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
}
</code></pre>
<h3 id="furtherlinks">Further Links</h3>
<ul>
<li><a href="http://www.mkyong.com/gradle/gradle-create-a-jar-file-with-dependencies/">Gradle – Create a Jar file with dependencies</a></li>
<li><a href="http://stackoverflow.com/questions/21721119/creating-runnable-jar-with-gradle">Creating runnable JAR with Gradle / StackOverflow</a></li>
</ul>

			</section>

			<section class="post-info">

				<div class="post-share">
					<a class="twitter" href="https://twitter.com/share?text=Kotlin Basics: Create Executable Kotlin JARs, using Gradle&url=https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
						<i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
					</a>
					<a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
						<i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
					</a>
					<a class="googleplus" href="https://plus.google.com/share?url=https://preslav.me/2016/06/13/kotlin-basics-create-an-executable-kotlin-jar-using-gradle/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
						<i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
					</a>
					<div class="clear"></div>
				</div>

				<aside class="post-tags">
					<a href="/tag/programming/">Programming</a> <a href="/tag/kotlin/">Kotlin</a> <a href="/tag/gradle/">Gradle</a>
				</aside>

				<div class="clear"></div>
						<aside class="post-author">
							<figure class="post-author-avatar avatar">
									<img src="/content/images/2018/12/3Uv6SjbG_400x400.jpg" alt="Preslav Rachev" />
							</figure>
							<div class="post-author-bio">
								<h4 class="post-author-name"><a href="/author/preslav/">Preslav Rachev</a></h4>
									<p class="post-author-about">I am a software engineer at KI labs GmbH and advocate for strong developer culture. In my free time, I enjoy running in the woods, reading a great book, or working on my next piece of writing/music.</p>
								<style>
									.bmc-button img {
										width: 27px !important;
										margin-bottom: 1px !important;
										box-shadow: none !important;
										border: none !important;
										vertical-align: middle !important;
									}
								
									.bmc-button {
										line-height: 36px !important;
										height: 37px !important;
										text-decoration: none !important;
										display: inline-flex !important;
										color: #ffffff !important;
										background-color: #FF813F !important;
										border-radius: 3px !important;
										border: 1px solid transparent !important;
										padding: 1px 9px !important;
										font-size: 22px !important;
										letter-spacing: 0.6px !important;
										box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
										-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
										margin: 0 auto !important;
										font-family: 'Cookie', cursive !important;
										-webkit-box-sizing: border-box !important;
										box-sizing: border-box !important;
										-o-transition: 0.3s all linear !important;
										-webkit-transition: 0.3s all linear !important;
										-moz-transition: 0.3s all linear !important;
										-ms-transition: 0.3s all linear !important;
										transition: 0.3s all linear !important;
									}
								
									.bmc-button:hover,
									.bmc-button:active,
									.bmc-button:focus {
										-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
										text-decoration: none !important;
										box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
										opacity: 0.85 !important;
										color: #ffffff !important;
									}
								</style>
								<link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><a class="bmc-button" target="_blank"
									href="https://www.buymeacoffee.com/0B7zhlQ2I"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg"
										alt="Buy me a coffee"><span style="margin-left:5px; margin-top: 0px; margin-right: 0px; font-size: 1em">Buy me a coffee</span></a>
								<br/>
									<span class="post-author-location"><i class="ic ic-location"></i> Munich, Germany</span>
								<div class="post-author-social">
									<ul>
										<li><a href="http://twitter.com/preslavrachev" class="smallsocial twitter" target="_blank"><i class="ic ic-twitter"></i></a></li>
										<li><a href="http://github.com/preslavrachev" class="smallsocial github" target="_blank"><i class="fab fa-github"></i></a></li>
										<li><a href="https://plus.google.com/+PreslavRachev" class="smallsocial googleplus" target="_blank"><i
												 class="fab fa-google-plus"></i></a></li>
										<li><a href="http://www.linkedin.com/in/preslavrachev" class="smallsocial linkedin" target="_blank"><i class="fab fa-linkedin"></i></a></li>
										<li><a href="https://stackoverflow.com/users/1107412/preslav-rachev" class="smallsocial stackoverflow" target="_blank"><i
												 class="fab fa-stack-overflow"></i></a></li>
									</ul>
								</div>
							</div>
							<div class="clear"></div>
						</aside>
			</section>


			<section class="post-comments">
				<script src="https://utteranc.es/client.js" 
                        repo="preslavrachev/preslav.me-comments" 
                        issue-term="pathname" 
                        theme="github-light"
                        crossorigin="anonymous" 
                        async>
                </script>
			</section>

			<aside class="post-nav">
					<a class="post-nav-next" href="/2016/06/26/kotlin-basics-apply-and-copy/">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-left"></i>
								<h2 class="post-nav-title">Kotlin Basics: apply() and copy()</h2>
								<p class="post-nav-excerpt">Without any doubt, Java is a verbose language. This verbosity of the&hellip;</p>
						</section>
					</a>
					<a class="post-nav-prev" href="/2015/02/21/what-s-with-the-50-72-rule/">
						<section class="post-nav-teaser">
							<i class="ic ic-arrow-right"></i>
								<h2 class="post-nav-title">What’s with the 50/72 rule?</h2>
								<p class="post-nav-excerpt">It is part of common sense to assume that the worthiest commit&hellip;</p>
						</section>
					</a>
				<div class="clear"></div>
			</aside>
		</div>
	</article>
</main>


		<div id="body-class" style="display: none;" class="post-template tag-programming tag-kotlin tag-gradle"></div>

		<footer id="footer">
			<div class="inner">
				<section class="credits">
					<span class="credits-theme">Theme <a href="https://github.com/zutrinken/attila">Attila</a> by <a href="https://zutrinken.com" rel="nofollow">zutrinken</a></span>
					<span class="credits-software">Published with <a href="https://ghost.org">Ghost</a></span>
				</section>
			</div>
		</footer>
	</section>

	<script type="text/javascript" src="/assets/js/script.js?v=7d79bd6108"></script>

	<!-- Clicky Analytics -->
<script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101131786);</script>
<script async src="//static.getclicky.com/js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131031623-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131031623-1');
    
  function handler() {
        if (scroll_count === 200) {
            document.removeEventListener('scroll', handler);
            gtag('event', 'scroll', {
  				'event_category' : 'behaviour',
  				'event_label' : 'scroll'
			});
        } else {
            scroll_count += 1;
        }
    }

  scroll_count = 0;
  document.addEventListener('scroll', handler)
</script>

<script>
    window.cookieconsent.initialise({
    container: document.getElementById("content"),
    palette:{
      popup: {background: "#fff"},
      button: {background: "#26a8ed", text: "#fff"},
    },
    revokable:false,
    onStatusChange: function(status) {
      if (this.hasConsented()) {
      	mixpanel.track("Accepts cookie consent");
      }
    },
    law: {
      regionalLaw: true,
    },
    location: true,
    content: {
    	message: "This blog uses cookies and collects limited analytics, to ensure you get the best reading experience."
    },
    position: "bottom-right"
  });
</script> 

<script src="https://www.gitcdn.xyz/repo/alexritchey/Ghost-Archives/master/src/jquery.ghostArchives.js"></script>

</body>
</html>
